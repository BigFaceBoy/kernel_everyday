# gelu 计算公式
$$
f(x) = \frac{1}{2} x(1+tanh(\sqrt{\frac{2}{\pi}}(x+0.044715x^3)))
$$

坑爹deepseek-V3 竟然说 cuda 提供了半精度的 _htanh 函数！

# benchmark
-------------------------------------------------------------------------------------
                                        S=1024, K=1024
           out_f32: [1.49359286, 0.65335011], time:0.01088476ms
         out_f32x4: [1.49359286, 0.65335011], time:0.01008534ms
        out_f32_th: [1.49359286, 0.65335011], time:0.01481867ms
-------------------------------------------------------------------------------------
           out_f16: [1.49316406, 0.65332031], time:0.01090693ms
         out_f16x2: [1.49316406, 0.65332031], time:0.00910330ms
         out_f16x8: [1.49316406, 0.65332031], time:0.00937462ms
     out_f16x8pack: [1.49316406, 0.65332031], time:0.00870156ms
        out_f16_th: [1.49316406, 0.65332031], time:0.01462531ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=1024, K=2048
           out_f32: [-0.15375914, -0.10854534], time:0.01265669ms
         out_f32x4: [-0.15375914, -0.10854534], time:0.01188540ms
        out_f32_th: [-0.15375914, -0.10854534], time:0.01796556ms
-------------------------------------------------------------------------------------
           out_f16: [-0.15380859, -0.10852051], time:0.01254296ms
         out_f16x2: [-0.15380859, -0.10852051], time:0.01185179ms
         out_f16x8: [-0.15380859, -0.10852051], time:0.01090002ms
     out_f16x8pack: [-0.15380859, -0.10852051], time:0.00993395ms
        out_f16_th: [-0.15380859, -0.10852051], time:0.01552439ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=1024, K=4096
           out_f32: [0.43297437, -0.16811463], time:0.01718616ms
         out_f32x4: [0.43297437, -0.16811463], time:0.01583433ms
        out_f32_th: [0.43297437, -0.16811463], time:0.02135062ms
-------------------------------------------------------------------------------------
           out_f16: [0.43261719, -0.16821289], time:0.01727724ms
         out_f16x2: [0.43261719, -0.16821289], time:0.01652861ms
         out_f16x8: [0.43261719, -0.16821289], time:0.01670861ms
     out_f16x8pack: [0.43261719, -0.16821289], time:0.01253057ms
        out_f16_th: [0.43286133, -0.16809082], time:0.01716709ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=1024
           out_f32: [0.04450732, 0.96646816], time:0.01391006ms
         out_f32x4: [0.04450732, 0.96646816], time:0.01174164ms
        out_f32_th: [0.04450732, 0.96646816], time:0.01744533ms
-------------------------------------------------------------------------------------
           out_f16: [0.04449463, 0.96630859], time:0.01425672ms
         out_f16x2: [0.04449463, 0.96630859], time:0.01076889ms
         out_f16x8: [0.04449463, 0.96630859], time:0.01102638ms
     out_f16x8pack: [0.04449463, 0.96630859], time:0.00984716ms
        out_f16_th: [0.04449463, 0.96630859], time:0.01523495ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=2048
           out_f32: [0.27026063, 0.44943216], time:0.01716256ms
         out_f32x4: [0.27026063, 0.44943216], time:0.01513815ms
        out_f32_th: [0.27026063, 0.44943216], time:0.02097678ms
-------------------------------------------------------------------------------------
           out_f16: [0.27026367, 0.44946289], time:0.01722598ms
         out_f16x2: [0.27026367, 0.44946289], time:0.01582241ms
         out_f16x8: [0.27026367, 0.44946289], time:0.01508760ms
     out_f16x8pack: [0.27026367, 0.44946289], time:0.01190448ms
        out_f16_th: [0.27026367, 0.44946289], time:0.01724792ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=4096
           out_f32: [0.42532936, -0.00850541], time:0.02624655ms
         out_f32x4: [0.42532936, -0.00850541], time:0.02295566ms
        out_f32_th: [0.42532936, -0.00850541], time:0.05387807ms
-------------------------------------------------------------------------------------
           out_f16: [0.42529297, -0.00850677], time:0.02640986ms
         out_f16x2: [0.42529297, -0.00850677], time:0.02724051ms
         out_f16x8: [0.42529297, -0.00850677], time:0.02600241ms
     out_f16x8pack: [0.42529297, -0.00850677], time:0.01711178ms
        out_f16_th: [0.42504883, -0.00849915], time:0.02124166ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=1024
           out_f32: [-0.10801527, 0.44606933], time:0.02006578ms
         out_f32x4: [-0.10801527, 0.44606933], time:0.01502705ms
        out_f32_th: [-0.10801527, 0.44606933], time:0.02098203ms
-------------------------------------------------------------------------------------
           out_f16: [-0.10797119, 0.44604492], time:0.02089310ms
         out_f16x2: [-0.10797119, 0.44604492], time:0.01368809ms
         out_f16x8: [-0.10797119, 0.44604492], time:0.01436925ms
     out_f16x8pack: [-0.10797119, 0.44604492], time:0.01162887ms
        out_f16_th: [-0.10809326, 0.44604492], time:0.01737547ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=2048
           out_f32: [-0.11933223, 0.04637312], time:0.02621794ms
         out_f32x4: [-0.11933223, 0.04637312], time:0.02159047ms
        out_f32_th: [-0.11933223, 0.04637312], time:0.05214596ms
-------------------------------------------------------------------------------------
           out_f16: [-0.11920166, 0.04638672], time:0.02638340ms
         out_f16x2: [-0.11920166, 0.04638672], time:0.02390957ms
         out_f16x8: [-0.11920166, 0.04638672], time:0.02428865ms
     out_f16x8pack: [-0.11920166, 0.04638672], time:0.01519752ms
        out_f16_th: [-0.11938477, 0.0463562], time:0.02119875ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=4096
           out_f32: [-0.152052, -0.10798237], time:0.19910932ms
         out_f32x4: [-0.152052, -0.10798237], time:0.19873095ms
        out_f32_th: [-0.152052, -0.10798237], time:0.22041225ms
-------------------------------------------------------------------------------------
           out_f16: [-0.15209961, -0.10803223], time:0.04454899ms
         out_f16x2: [-0.15209961, -0.10803223], time:0.04251838ms
         out_f16x8: [-0.15209961, -0.10803223], time:0.04494739ms
     out_f16x8pack: [-0.15209961, -0.10803223], time:0.02580500ms
        out_f16_th: [-0.15197754, -0.10797119], time:0.05101156ms
-------------------------------------------------------------------------------------