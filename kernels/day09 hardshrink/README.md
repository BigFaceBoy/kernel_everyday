# hardshrink
$$
Hardshrink(x) = \begin{cases}
    x  &\text{ x > $\lambda$} \\
    x &\text{ x < $-\lambda$} \\
    0 &\text{$-\lambda$ <= x <= $\lambda$}
\end{cases}
$$

# benchmark

-------------------------------------------------------------------------------------
                                        S=1024, K=1024
           out_f32: ['-0.83420789 ', '0.0         '], time:0.00991201ms
         out_f32x4: ['-0.83420789 ', '0.0         '], time:0.00923729ms
        out_f32_th: ['-0.83420789 ', '0.0         '], time:0.02623868ms
-------------------------------------------------------------------------------------
           out_f16: ['-0.83398438 ', '0.0         '], time:0.00994897ms
         out_f16x2: ['-0.83398438 ', '0.0         '], time:0.00874162ms
         out_f16x8: ['-0.83398438 ', '0.0         '], time:0.00868344ms
     out_f16x8pack: ['-0.83398438 ', '0.0         '], time:0.00864768ms
        out_f16_th: ['-0.83398438 ', '0.0         '], time:0.02471113ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=1024, K=2048
           out_f32: ['-1.66530573 ', '-0.70693219 '], time:0.01205420ms
         out_f32x4: ['-1.66530573 ', '-0.70693219 '], time:0.01093626ms
        out_f32_th: ['-1.66530573 ', '-0.70693219 '], time:0.02982259ms
-------------------------------------------------------------------------------------
           out_f16: ['-1.66503906 ', '-0.70703125 '], time:0.01213360ms
         out_f16x2: ['-1.66503906 ', '-0.70703125 '], time:0.01068258ms
         out_f16x8: ['-1.66503906 ', '-0.70703125 '], time:0.00948644ms
     out_f16x8pack: ['-1.66503906 ', '-0.70703125 '], time:0.00932193ms
        out_f16_th: ['-1.66503906 ', '-0.70703125 '], time:0.02633524ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=1024, K=4096
           out_f32: ['0.77850503  ', '0.0         '], time:0.01643825ms
         out_f32x4: ['0.77850503  ', '0.0         '], time:0.01401925ms
        out_f32_th: ['0.77850503  ', '0.0         '], time:0.03691578ms
-------------------------------------------------------------------------------------
           out_f16: ['0.77832031  ', '0.0         '], time:0.01648688ms
         out_f16x2: ['0.77832031  ', '0.0         '], time:0.01631260ms
         out_f16x8: ['0.77832031  ', '0.0         '], time:0.01149917ms
     out_f16x8pack: ['0.77832031  ', '0.0         '], time:0.01115966ms
        out_f16_th: ['0.77832031  ', '0.0         '], time:0.02970409ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=1024
           out_f32: ['1.03780258  ', '0.0         '], time:0.01248622ms
         out_f32x4: ['1.03780258  ', '0.0         '], time:0.01086473ms
        out_f32_th: ['1.03780258  ', '0.0         '], time:0.02994633ms
-------------------------------------------------------------------------------------
           out_f16: ['1.03808594  ', '0.0         '], time:0.01261616ms
         out_f16x2: ['1.03808594  ', '0.0         '], time:0.00994682ms
         out_f16x8: ['1.03808594  ', '0.0         '], time:0.00957990ms
     out_f16x8pack: ['1.03808594  ', '0.0         '], time:0.00954366ms
        out_f16_th: ['1.03808594  ', '0.0         '], time:0.02647758ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=2048
           out_f32: ['0.86521965  ', '2.39560223  '], time:0.01645017ms
         out_f32x4: ['0.86521965  ', '2.39560223  '], time:0.01415539ms
        out_f32_th: ['0.86521965  ', '2.39560223  '], time:0.03678846ms
-------------------------------------------------------------------------------------
           out_f16: ['0.86523438  ', '2.39648438  '], time:0.01645780ms
         out_f16x2: ['0.86523438  ', '2.39648438  '], time:0.01361489ms
         out_f16x8: ['0.86523438  ', '2.39648438  '], time:0.01139140ms
     out_f16x8pack: ['0.86523438  ', '2.39648438  '], time:0.01114440ms
        out_f16_th: ['0.86523438  ', '2.39648438  '], time:0.02964187ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=4096
           out_f32: ['-0.66421831 ', '-1.5653652  '], time:0.02514362ms
         out_f32x4: ['-0.66421831 ', '-1.5653652  '], time:0.02058053ms
        out_f32_th: ['-0.66421831 ', '-1.5653652  '], time:0.06008577ms
-------------------------------------------------------------------------------------
           out_f16: ['-0.6640625  ', '-1.56542969 '], time:0.02524257ms
         out_f16x2: ['-0.6640625  ', '-1.56542969 '], time:0.02494407ms
         out_f16x8: ['-0.6640625  ', '-1.56542969 '], time:0.01500773ms
     out_f16x8pack: ['-0.6640625  ', '-1.56542969 '], time:0.01439214ms
        out_f16_th: ['-0.6640625  ', '-1.56542969 '], time:0.03630948ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=1024
           out_f32: ['0.92571795  ', '1.38990092  '], time:0.01748991ms
         out_f32x4: ['0.92571795  ', '1.38990092  '], time:0.01410508ms
        out_f32_th: ['0.92571795  ', '1.38990092  '], time:0.03641534ms
-------------------------------------------------------------------------------------
           out_f16: ['0.92578125  ', '1.38964844  '], time:0.01774502ms
         out_f16x2: ['0.92578125  ', '1.38964844  '], time:0.01225257ms
         out_f16x8: ['0.92578125  ', '1.38964844  '], time:0.01137257ms
     out_f16x8pack: ['0.92578125  ', '1.38964844  '], time:0.01107335ms
        out_f16_th: ['0.92578125  ', '1.38964844  '], time:0.02943540ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=2048
           out_f32: ['-1.15481138 ', '0.0         '], time:0.02518582ms
         out_f32x4: ['-1.15481138 ', '0.0         '], time:0.02053189ms
        out_f32_th: ['-1.15481138 ', '0.0         '], time:0.06140780ms
-------------------------------------------------------------------------------------
           out_f16: ['-1.15527344 ', '0.0         '], time:0.02510762ms
         out_f16x2: ['-1.15527344 ', '0.0         '], time:0.01974034ms
         out_f16x8: ['-1.15527344 ', '0.0         '], time:0.01479316ms
     out_f16x8pack: ['-1.15527344 ', '0.0         '], time:0.01420593ms
        out_f16_th: ['-1.15527344 ', '0.0         '], time:0.03617477ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=4096
           out_f32: ['0.0         ', '-0.61456412 '], time:0.19639444ms
         out_f32x4: ['0.0         ', '-0.61456412 '], time:0.19643021ms
        out_f32_th: ['0.0         ', '-0.61456412 '], time:0.36791372ms
-------------------------------------------------------------------------------------
           out_f16: ['0.0         ', '-0.61474609 '], time:0.04250836ms
         out_f16x2: ['0.0         ', '-0.61474609 '], time:0.04224658ms
         out_f16x8: ['0.0         ', '-0.61474609 '], time:0.02194166ms
     out_f16x8pack: ['0.0         ', '-0.61474609 '], time:0.02089572ms
        out_f16_th: ['0.0         ', '-0.61474609 '], time:0.06194544ms
-------------------------------------------------------------------------------------